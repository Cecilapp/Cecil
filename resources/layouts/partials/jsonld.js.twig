{#- Structured data ~#}
    <script type="application/ld+json">{%- apply minify_js ~%}
      [
{#- WebSite ~#}
        {%- cache 'jsonld_website' ~ '__' ~ cecil.version ~%}
        {
          "@context": "https://schema.org",
          "@type": "WebSite",
          "name": "{{ site.title|e }}",
          "description": "{{ site.description|e }}",
          "url": "{{ url(site.home, {canonical: true}) }}"
          {%- if site.image is defined ~%},
          "image": [
            "{{ url(asset(site.image), {canonical: true}) }}"
          ]
          {%- endif ~%}
          {%- if page.social|default(site.social|default) ~%},
          "sameAs": [
            {%- for social in page.social|default(site.social)|filter((v) => v['url'] is defined) ~%}
            "{{ social.url }}"{% if not loop.last %},{% endif %}
            {%- endfor ~%}
          ]
          {%- endif ~%}
        }
        {%- endcache ~%}
{#- SiteNavigationElement ~#}
        {%- if site.menus.main is defined -%}
        {%- cache 'jsonld_navigation_' ~ hash(site.menus.main) ~ '__' ~ cecil.version -%}
        ,{
          "@context": "http://schema.org",
          "@type": "ItemList",
          "itemListElement": [
            {%- for item in site.menus.main|filter(i => i.id != site.home)|sort_by_weight ~%}
            {
              "@type": "SiteNavigationElement",
              "position": {{ loop.index }},
              "name": "{{ site.page(item.id).title|default(item.name)|e }}",
              "description": "{{ site.page(item.id).description|default|e }}",
              "url": "{{ url(item.url, {canonical: true}) }}"
            }{%- if not loop.last %},{% endif -%}
            {%~ endfor ~%}
          ]
        }
        {%- endcache ~%}
        {%- endif -%}
{#- WebPage ~#}
        {%- if page.id != '404' -%}
        ,{
          "@context": "http://schema.org",
          "@type": "WebPage",
          "name": "{{ title|default(page.title)|e }}",
          "description": "{{ page.description|default(site.description)|e }}",
          "publisher": {
            "@type": "Organization",
            "name": "{{ site.title|e }}",
            {%- set icon_asset = asset('icon.png', {'ignore_missing': true}) ~%}
            {%- if not icon_asset.missing ~%}
            "logo": "{{ url(icon_asset, {canonical: true}) }}",
            {%- endif ~%}
            "url": "{{ url(site.home, {canonical: true}) }}"
          }
        }
        {%- endif ~%}
        {%- if page.section -%}
{#- BreadcrumbList -#}
        ,{
          "@context": "https://schema.org",
          "@type": "BreadcrumbList",
          "itemListElement": [{
            "@type": "ListItem",
            "position": 1,
            "name": "{{ site.page(page.section).title|default(page.section)|e }}",
            "item": "{{ url(page.section, {canonical: true}) }}"
          {%- if page.type != 'section' ~%}
          },{
            "@type": "ListItem",
            "position": 2,
            "name": "{{ title|default(page.title)|e }}",
            "item": "{{ url(page, {canonical: true}) }}"
          {%- endif ~%}
          }]
        }
{#- NewsArticle ~#}
          {%- if page.section == config.metatags.articles|default('blog') and page.type != 'section' -%}
        ,{
          "@context": "https://schema.org",
          "@type": "NewsArticle",
          "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "{{ url(page, {canonical: true}) }}"
          },
          "headline": "{{ title|default(page.title)|e }}",
          {%- if page.image|default is not empty ~%}
          "image": [
            "{{ url(asset(page.image), {canonical: true}) }}"
          ],
          {%- endif ~%}
          "datePublished": "{{ page.date|date('Y-m-dTH:i:sP') }}",
          {%- if page.updated is defined ~%}
          "dateModified": "{{ page.updated|date('Y-m-dTH:i:sP') }}",
          {%- endif ~%}
          {%- if author.name|default is not empty ~%}
          "author": {
            "@type": "Person",
            "name": "{{ author.name|e }}"
            {%- if author.url|default is not empty ~%},
            "url": "{{ author.url }}"
            {%- endif ~%}
            {%- if author.image|default is not empty ~%},
            "image": "{{ author.image }}"
            {%- endif ~%}
            {%- if author.title|default is not empty ~%},
            "jobTitle": "{{ author.title }}"
            {%- endif ~%}
            {%- if author.email|default is not empty ~%},
            "email": "{{ author.email }}"
            {%- endif ~%}
            {%- if author.telephone|default is not empty ~%},
            "telephone": "{{ author.telephone }}"
            {%- endif ~%}
          },
          {%- endif ~%}
          "publisher": {
            "@type": "Organization",
            "name": "{{ site.title|e }}",
            {%- set icon_asset = asset('icon.png', {'ignore_missing': true}) ~%}
            {%- if not icon_asset.missing ~%}
            "logo": "{{ url(icon_asset, {canonical: true}) }}",
            {%- endif ~%}
            "url": "{{ url(site.home, {canonical: true}) }}"
          }
        }
          {%- endif ~%}
        {%- endif ~%}
{#- VideoObject ~#}
        {%- if page.videos[0] is defined -%}
        ,{
          "@context": "https://schema.org",
          "@type": "VideoObject",
          "name": "{{ title|default(page.title)|e }}",
          {%- if page.description is defined ~%}
          "description": "{{ page.description|e }}",
          {%- endif ~%}
          {%- if page.image|default is not empty ~%}
          "thumbnailUrl": [
            "{{ url(asset(page.image)|resize(640), {canonical: true}) }}"
          ],
          {%- endif ~%}
          "uploadDate": "{{ page.date|date('Y-m-dTH:i:sP') }}",
          "duration": "{{ asset(page.videos[0]).video.duration|duration_to_iso8601 }}",
          "contentUrl": "{{ url(asset(page.videos[0]), {canonical: true}) }}",
          "embedUrl": "{{ url(page, {canonical: true, format: 'embed'}) }}"
        }
        {%- endif ~%}
      ]
    {% endapply %}</script>